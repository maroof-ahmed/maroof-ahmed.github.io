"use strict";angular.module("USD$").controller("homeController",["$scope","$http","$filter","$sce",function(e,t,a,i){e.page="Home",app.showProcessing(),$(".active-pill").removeClass("active-pill"),$(".home-pill").addClass("active-pill");var r="http://api.dronestre.am/data";r=i.trustAsResourceUrl(r),e.onDataResponse=function(t){if(console.log("data",t),200==t.status){app.hideProcessing(),e.droneData=t.data.strike.reverse(),e.droneData.forEach(function(e){"Pakistan-Afghanistan Border"==e.country&&(e.country="Pakistan")}),e.isDbData&&(e.droneData=t.data.strike.reverse());var i=e.droneData;console.log("dData",i),$.ajax({type:"POST",url:"savedata.php",data:{droneStreamData:JSON.stringify(i)},dataType:"json",success:function(e){console.log("response",e)},error:function(e){console.log("error",e)}}),$("body").animate({scrollTop:$("body").offset().top},1),e.monthsArr=[0,"January","February","March","April","May","June","July","August","September","October","November","December"],e.allCountries=[],e.allYears=[],i.forEach(function(t){t.targetText=t.target,t.targetText&&t.targetText.indexOf(";")>=0?(t.targetText=t.targetText.split(";"),t.targetText=t.targetText[0]+" and Others"):i.targetText=i.target,t.names[0]||(t.names=[t.names]),""!=t.names[0]?t.namesArray=t.names[0].split(","):t.namesArray=[],e.allCountries.indexOf(t.country)==-1&&e.allCountries.push(t.country),e.allYears.indexOf(a("date")(t.date,"yyyy"))==-1&&e.allYears.push(a("date")(t.date,"yyyy")),"Maulvi Liaqat"==t.target&&console.log("droneData.targetText ",t)}),e.initialDroneData=e.droneData,console.log("$scope.allCountries",e.allCountries),e.filterByDeaths=function(e){return parseInt(e.deaths_max)?parseInt(e.deaths_max):"Unknown"==e.deaths?-1:parseInt(e.deaths)},e.sortByDeaths=function(e){return parseInt(e.deaths_max)?parseInt(e.deaths_max):"Unknown"==e.deaths?0:parseInt(e.deaths)},e.sortByInjuries=function(e){var t=""!=e.injuries?e.injuries:"0";return t.indexOf("-")!=-1?(t=parseInt(t.split("-").pop()),isNaN(t)&&(t=parseInt(e.injuries.split("-")[0]))):t.indexOf("Unknown")!=-1||t.indexOf("Possibl")!=-1||t.indexOf("Yes")!=-1?civilians=1:"Dozens"==t?t=24:"Some"==t?t=7:"Several"==t?t=30:t.indexOf("Many")!=-1?civilians=10:t.indexOf("At least")!=-1&&(t=t.replace("At least"," "),t=t.split(" "),t.forEach(function(e){isNaN(parseInt(e))||(t=parseInt(e))})),parseInt(t)},e.sortByCivilianDeaths=function(e){var t=""!=e.civilians?e.civilians:"0";return t.indexOf("-")!=-1?(t=parseInt(t.split("-").pop()),isNaN(t)&&(t=parseInt(e.civilians.split("-")[0]))):t.indexOf("Unknown")!=-1||t.indexOf("Possibl")!=-1||t.indexOf("Yes")!=-1?t=1:t.indexOf("Some")!=-1?t=7:t.indexOf("At least")!=-1?(t=t.replace("At least"," "),t=t.split(" "),t.forEach(function(e){isNaN(parseInt(e))||(t=parseInt(e))})):t.indexOf("Many")!=-1?t=10:isNaN(t)&&console.log("civilians",t),parseInt(t)},e.sortByChildDeaths=function(e){var t=""!=e.children?e.children:"0";return t.indexOf("-")!=-1?(t=parseInt(t.split("-").pop()),isNaN(t)&&(t=parseInt(e.children.split("-")[0]))):t.indexOf("Unknown")!=-1||t.indexOf("Possibl")!=-1||t.indexOf("Yes")!=-1?t=1:t.indexOf("At least")!=-1?(t=t.replace("At least"," "),t=t.split(" "),t.forEach(function(e){isNaN(parseInt(e))||(t=parseInt(e))})):isNaN(t)&&console.log("children",t),parseInt(t)},e.search={filterDeathsInjuries:9999,filterMonth:"",filterFromMonth:"",filterToMonth:"",filterFromYear:"",filterToYear:""},e.setFilterVal=function(t){if(i=e.droneData,this.search.filterCountry)if(""!=this.search.filterCountry){var r=this;i=a("filter")(e.droneData,function(e,t,a){var i=e.country;return i==r.search.filterCountry}),e.totalStrikesSince2004=0,e.totalMinDeathsSince2004=0,i.forEach(function(t){var r=a("date")(t.date,"yyyy"),n=t.deaths.indexOf("-")!=-1?t.deaths_min:t.deaths;"Unknown"==n&&(n="0"),e.countryLatestStrikeDate=a("orderBy")(i,"date",!0)[0].date,parseInt(r)>=2004&&(e.totalStrikesSince2004+=1,e.totalMinDeathsSince2004+=parseInt(n))})}else i=e.droneData;if(""==this.search.filterType)this.hasFilter=!1,i=""!=this.search.filterCountry?i:e.droneData,""==e.sorter,e.search.filterDeathsInjuries=0,this.setPage(1);else{if(this.hasFilter=!0,i=""!=this.search.filterCountry?i:e.droneData,"year"==this.search.filterType&&this.search.filterYear)if(""!=this.search.filterYear){console.log("YEAR?",this.search.filterYear,this.search.filterMonth);var r=this;i=a("filter")(i,function(e,t,i){var n=e.date,s=a("date")(n,"yyyy");if(""!=r.search.filterMonth){var o=a("date")(n,"MMMM");return o==r.search.filterMonth&&parseInt(s)==parseInt(r.search.filterYear)}return console.log("yr",parseInt(s),r.search.filterYear),parseInt(s)==parseInt(r.search.filterYear)})}else i=""!=this.search.filterCountry?i:e.droneData;if("from_to"==this.search.filterType){this.search.filterMonth="",this.search.filterYear="";var r=this;i=""!=this.search.filterFromYear&&""!=this.search.filterToYear?a("filter")(i,function(e,t,i){var n=e.date,s=a("date")(n,"yyyy");if(""!=r.search.filterFromMonth&&""!=r.search.filterToMonth){var o=(a("date")(n,"M"),new Date(n)),l=new Date(r.monthsArr[r.search.filterFromMonth]+" "+r.search.filterFromYear),d=new Date(r.monthsArr[r.search.filterToMonth]+" "+r.search.filterToYear);return o>=l&&o<=d}return parseInt(s)>=parseInt(r.search.filterFromYear)&&parseInt(s)<=parseInt(r.search.filterToYear)}):""!=this.search.filterCountry?i:e.droneData}if("deaths"==this.search.filterType){var r=this;i=a("filter")(i,function(e,t,a){var i=e.deaths.indexOf("-")!=-1?e.deaths_max:e.deaths;return"Unknown"==i&&(i="0"),parseInt(i)>=parseInt(r.search.filterDeathsInjuries)})}if("injuries"==this.search.filterType){var r=this;i=a("filter")(i,function(e,t,a){var i=""!=e.injuries?e.injuries:0;return e.injuries.indexOf("-")!=-1?i=parseInt(e.injuries.split("-").pop()):"Dozens"==i?i=24:"Some"==i?i=7:"Several"==i&&(i=30),parseInt(i)>=parseInt(r.search.filterDeathsInjuries)})}this.setPage(1)}e.summarizeResults(i)},e.summarizeResults=function(t){0!=t.length&&(e.totalStrikes=t.length,e.totalMaxDeaths=0,e.totalMinDeaths=0,e.totalInjuries=0,e.totalCiviliansKilled=0,e.totalChildrenKilled=0,e.lastStrikeDate=a("orderBy")(t,"date",!0)[0].date,e.previousStrikeDate=a("orderBy")(t,"date",!0)[1]&&a("orderBy")(t,"date",!0)[1].date?a("orderBy")(t,"date",!0)[1].date:"",e.firstStrikeDate=a("orderBy")(t,"date")[0].date,e.maximumDeaths=a("orderBy")(t,e.sortByDeaths,!0)[0].deaths,e.minimumDeaths=a("orderBy")(t,e.sortByDeaths)[0].deaths,e.maximumInjuries=a("orderBy")(t,e.sortByInjuries,!0)[0].injuries,""==e.maximumInjuries&&(e.maximumInjuries=0),e.minimumInjuries=a("orderBy")(t,e.sortByInjuries)[0].injuries,""==e.minimumInjuries&&(e.minimumInjuries=0),e.maximumCiviliansKilled=a("orderBy")(t,e.sortByCivilianDeaths,!0)[0].civilians,""==e.maximumCiviliansKilled&&(e.maximumCiviliansKilled=0),e.minimumCiviliansKilled=a("orderBy")(t,e.sortByCivilianDeaths)[0].civilians,""==e.minimumCiviliansKilled&&(e.minimumCiviliansKilled=0),e.maximumChildrenKilled=a("orderBy")(t,e.sortByChildDeaths,!0)[0].children,""==e.maximumChildrenKilled&&(e.maximumChildrenKilled=0),e.minimumChildrenKilled=a("orderBy")(t,e.sortByChildDeaths)[0].children,""==e.minimumChildrenKilled&&(e.minimumChildrenKilled=0),console.log("max min injuries",e.maximumInjuries,e.minimumInjuries),t.forEach(function(t,a){var i=t.deaths.indexOf("-")!=-1?t.deaths_max:t.deaths;"Unknown"!=i&&""!=i||(i="0");var r=t.deaths.indexOf("-")!=-1?t.deaths_min:t.deaths;"Unknown"!=r&&""!=r||(r="0"),e.totalMaxDeaths+=parseInt(i),e.totalMinDeaths+=parseInt(r);var n=""!=t.injuries?t.injuries:"0";n.indexOf("-")!=-1?(n=parseInt(n.split("-").pop()),isNaN(n)&&(n=parseInt(t.injuries.split("-")[0]))):n.indexOf("Unknown")!=-1||n.indexOf("Possibl")!=-1||n.indexOf("Yes")!=-1?s=1:"Dozens"==n?n=24:"Some"==n?n=7:"Several"==n?n=30:n.indexOf("Many")!=-1?s=10:n.indexOf("At least")!=-1&&(n=n.replace("At least"," "),n=n.split(" "),n.forEach(function(e){isNaN(parseInt(e))||(n=parseInt(e))})),e.totalInjuries+=parseInt(n);var s=""!=t.civilians?t.civilians:"0";s.indexOf("-")!=-1?(s=parseInt(s.split("-").pop()),isNaN(s)&&(s=parseInt(t.civilians.split("-")[0]))):s.indexOf("Unknown")!=-1||s.indexOf("Possibl")!=-1||s.indexOf("Yes")!=-1?s=1:s.indexOf("Some")!=-1?s=7:s.indexOf("At least")!=-1?(s=s.replace("At least"," "),s=s.split(" "),s.forEach(function(e){isNaN(parseInt(e))||(s=parseInt(e))})):s.indexOf("Many")!=-1?s=10:isNaN(s)&&console.log("civilians",s),e.totalCiviliansKilled+=parseInt(s);var o=""!=t.children?t.children:"0";o.indexOf("-")!=-1?(o=parseInt(o.split("-").pop()),isNaN(o)&&(o=parseInt(t.children.split("-")[0]))):o.indexOf("Unknown")!=-1||o.indexOf("Possibl")!=-1||o.indexOf("Yes")!=-1?o=1:o.indexOf("At least")!=-1?(o=o.replace("At least"," "),o=o.split(" "),o.forEach(function(e){isNaN(parseInt(e))||(o=parseInt(e))})):isNaN(o)&&console.log("children",o),e.totalChildrenKilled+=parseInt(o)}),e.showSummaryCharts(t))},e.showSummaryCharts=function(t){e.chartStrikesPerYear(t),e.chartStrikesPerMonth(t),e.chartKillsPerYear(t),e.chartKillsPerMonth(t),e.chartChildCivilianKillsPerYear(t),e.chartChildCivilianKillsPerMonth(t),e.chartsLoaded=!0},e.chartStrikesPerYear=function(t){if(t.length>0){var i=echarts.init(document.getElementById("chartStrikesPerYear")),r=[];t.forEach(function(e){var t=a("date")(e.date,"yyyy");r.indexOf(t)==-1&&r.push(t)});var n=[];r.forEach(function(e){var i=0;t.forEach(function(t){var r=a("date")(t.date,"yyyy");parseInt(r)==parseInt(e)&&(i+=1)}),n.push(i)});var s=n.indexOf(Math.max.apply(window,n));e.yearOfMaxStrikes=r[s];var o={color:["#3398DB"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"0%",right:"0%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:r,axisTick:{alignWithLabel:!0},axisLine:{lineStyle:{color:"#445b77"}}}],yAxis:[{type:"value",axisLine:{lineStyle:{color:"#445b77"}}}],series:[{name:"Total Strikes",type:"bar",barWidth:"60%",data:n}],textStyle:{color:"rgba(255, 255, 255, 1)"}};i.setOption(o)}},e.chartStrikesPerMonth=function(e){var t=this,i=echarts.init(document.getElementById("chartStrikesPerMonth")),r=new Date(t.firstStrikeDate),n=new Date(t.lastStrikeDate);if(""!=t.search.filterFromMonth&&""!=t.search.filterToMonth)var r=new Date(t.monthsArr[t.search.filterFromMonth]+" "+t.search.filterFromYear),n=new Date(t.monthsArr[t.search.filterToMonth]+" "+t.search.filterToYear);for(var s=[];r<=n;)s.push(new Date(r)),r=r.addMonths(1);var o=[];s.forEach(function(e){var t=a("date")(e,"MMM yyyy");o.push(t)});var l=[];s.forEach(function(t){var i=0;e.forEach(function(e){var r=a("date")(e.date,"MMM"),n=a("date")(e.date,"yyyy"),s=a("date")(t,"MMM"),o=a("date")(t,"yyyy");parseInt(n)==parseInt(o)&&r==s&&(i+=1)}),l.push(i)});var d={color:["#3398DB"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"0%",right:"0%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:o,axisTick:{alignWithLabel:!0},axisLine:{lineStyle:{color:"#445b77"}}}],yAxis:[{type:"value",axisLine:{lineStyle:{color:"#445b77"}}}],series:[{name:"Total Strikes",type:"bar",barWidth:"60%",data:l}],textStyle:{color:"rgba(255, 255, 255, 1)"}};i.setOption(d)},e.chartKillsPerYear=function(e){if(e.length>0){var t=echarts.init(document.getElementById("chartKillsPerYear")),i=[];e.forEach(function(e){var t=a("date")(e.date,"yyyy");i.indexOf(t)==-1&&i.push(t)});var r=[],n=[],s=[];i.forEach(function(t){var i=0,o=0,l=0;e.forEach(function(e){var r=a("date")(e.date,"yyyy"),n=e.deaths.indexOf("-")!=-1?e.deaths_max:e.deaths;"Unknown"==n&&(n="0");var s=e.deaths.indexOf("-")!=-1?e.deaths_min:e.deaths;"Unknown"==s&&(s="0");var d=""!=e.injuries?e.injuries:"0";d.indexOf("-")!=-1?(d=parseInt(d.split("-").pop()),isNaN(d)&&(d=parseInt(e.injuries.split("-")[0]))):d.indexOf("Unknown")!=-1||d.indexOf("Possibl")!=-1||d.indexOf("Yes")!=-1?civilians=1:"Dozens"==d?d=24:"Some"==d?d=7:"Several"==d?d=30:d.indexOf("Many")!=-1?civilians=10:d.indexOf("At least")!=-1&&(d=d.replace("At least"," "),d=d.split(" "),d.forEach(function(e){isNaN(parseInt(e))||(d=parseInt(e))})),parseInt(r)==parseInt(t)&&(i+=parseInt(n),o+=parseInt(s),l+=parseInt(d))}),r.push(i),n.push(o),s.push(l)});var o={color:["#ca5452","#ccc","#dfd168"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"0%",right:"0%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:i,axisTick:{alignWithLabel:!0},axisLine:{lineStyle:{color:"#445b77"}}}],yAxis:[{type:"value",axisLine:{lineStyle:{color:"#445b77"}}}],series:[{name:"Max Total Kills",type:"bar",data:r},{name:"Min Total Kills",type:"bar",data:n},{name:"Total Injuries",type:"bar",data:s}],textStyle:{color:"rgba(255, 255, 255, 1)"}};t.setOption(o)}},e.chartKillsPerMonth=function(e){var t=this,i=echarts.init(document.getElementById("chartKillsPerMonth")),r=new Date(t.firstStrikeDate),n=new Date(t.lastStrikeDate);if(""!=t.search.filterFromMonth&&""!=t.search.filterToMonth)var r=new Date(t.monthsArr[t.search.filterFromMonth]+" "+t.search.filterFromYear),n=new Date(t.monthsArr[t.search.filterToMonth]+" "+t.search.filterToYear);for(var s=[];r<=n;)s.push(new Date(r)),r=r.addMonths(1);var o=[];s.forEach(function(e){var t=a("date")(e,"MMM yyyy");o.push(t)});var l=[],d=[],h=[];s.forEach(function(t){var i=0,r=0,n=0;e.forEach(function(e){var s=a("date")(e.date,"MMM"),o=a("date")(e.date,"yyyy"),l=a("date")(t,"MMM"),d=a("date")(t,"yyyy"),h=e.deaths.indexOf("-")!=-1?e.deaths_max:e.deaths;"Unknown"==h&&(h="0");var c=e.deaths.indexOf("-")!=-1?e.deaths_min:e.deaths;"Unknown"==c&&(c="0");var p=""!=e.injuries?e.injuries:"0";p.indexOf("-")!=-1?(p=parseInt(p.split("-").pop()),isNaN(p)&&(p=parseInt(e.injuries.split("-")[0]))):p.indexOf("Unknown")!=-1||p.indexOf("Possibl")!=-1||p.indexOf("Yes")!=-1?civilians=1:"Dozens"==p?p=24:"Some"==p?p=7:"Several"==p?p=30:p.indexOf("Many")!=-1?civilians=10:p.indexOf("At least")!=-1&&(p=p.replace("At least"," "),p=p.split(" "),p.forEach(function(e){isNaN(parseInt(e))||(p=parseInt(e))})),parseInt(o)==parseInt(d)&&s==l&&(i+=parseInt(h),r+=parseInt(c),n+=parseInt(p))}),l.push(i),d.push(r),h.push(n)});var c={color:["#ca5452","#ccc","#dfd168"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"0%",right:"0%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:o,axisTick:{alignWithLabel:!0},axisLine:{lineStyle:{color:"#445b77"}}}],yAxis:[{type:"value",axisLine:{lineStyle:{color:"#445b77"}}}],series:[{name:"Max Total Kills",type:"bar",data:l},{name:"Min Total Kills",type:"bar",data:d},{name:"Total Injuries",type:"bar",data:h}],textStyle:{color:"rgba(255, 255, 255, 1)"}};i.setOption(c)},e.chartChildCivilianKillsPerYear=function(e){if(e.length>0){var t=echarts.init(document.getElementById("chartChildCivilianKillsPerYear")),i=[];e.forEach(function(e){var t=a("date")(e.date,"yyyy");i.indexOf(t)==-1&&i.push(t)});var r=[],n=[];i.forEach(function(t){var i=0,s=0;e.forEach(function(e){var r=a("date")(e.date,"yyyy"),n=""!=e.civilians?e.civilians:"0";n.indexOf("-")!=-1?(n=parseInt(n.split("-").pop()),isNaN(n)&&(n=parseInt(e.civilians.split("-")[0]))):n.indexOf("Unknown")!=-1||n.indexOf("Possibl")!=-1||n.indexOf("Yes")!=-1?n=1:n.indexOf("Some")!=-1?n=7:n.indexOf("At least")!=-1?(n=n.replace("At least"," "),n=n.split(" "),n.forEach(function(e){isNaN(parseInt(e))||(n=parseInt(e))})):n.indexOf("Many")!=-1?n=10:isNaN(n)&&console.log("civilians",n);var o=""!=e.children?e.children:"0";o.indexOf("-")!=-1?(o=parseInt(o.split("-").pop()),isNaN(o)&&(o=parseInt(e.children.split("-")[0]))):o.indexOf("Unknown")!=-1||o.indexOf("Possibl")!=-1||o.indexOf("Yes")!=-1?o=1:o.indexOf("At least")!=-1?(o=o.replace("At least"," "),o=o.split(" "),o.forEach(function(e){isNaN(parseInt(e))||(o=parseInt(e))})):isNaN(o)&&console.log("children",o),parseInt(r)==parseInt(t)&&(i+=parseInt(n),s+=parseInt(o))}),r.push(i),n.push(s)});var s={color:["#84e1cb","#e97b21"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"0%",right:"0%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:i,axisTick:{alignWithLabel:!0},axisLine:{lineStyle:{color:"#445b77"}}}],yAxis:[{type:"value",axisLine:{lineStyle:{color:"#445b77"}}}],series:[{name:"Civilians Killed",type:"bar",data:r},{name:"Children Killed",type:"bar",data:n}],textStyle:{color:"rgba(255, 255, 255, 1)"}};t.setOption(s)}},e.chartChildCivilianKillsPerMonth=function(e){var t=this,i=echarts.init(document.getElementById("chartChildCivilianKillsPerMonth")),r=new Date(t.firstStrikeDate),n=new Date(t.lastStrikeDate);if(""!=t.search.filterFromMonth&&""!=t.search.filterToMonth)var r=new Date(t.monthsArr[t.search.filterFromMonth]+" "+t.search.filterFromYear),n=new Date(t.monthsArr[t.search.filterToMonth]+" "+t.search.filterToYear);for(var s=[];r<=n;)s.push(new Date(r)),r=r.addMonths(1);var o=[];s.forEach(function(e){var t=a("date")(e,"MMM yyyy");o.push(t)});var l=[],d=[];s.forEach(function(t){var i=0,r=0;e.forEach(function(e){var n=a("date")(e.date,"MMM"),s=a("date")(e.date,"yyyy"),o=a("date")(t,"MMM"),l=a("date")(t,"yyyy"),d=""!=e.civilians?e.civilians:"0";d.indexOf("-")!=-1?(d=parseInt(d.split("-").pop()),isNaN(d)&&(d=parseInt(e.civilians.split("-")[0]))):d.indexOf("Unknown")!=-1||d.indexOf("Possibl")!=-1||d.indexOf("Yes")!=-1?d=1:d.indexOf("Some")!=-1?d=7:d.indexOf("At least")!=-1?(d=d.replace("At least"," "),d=d.split(" "),d.forEach(function(e){isNaN(parseInt(e))||(d=parseInt(e))})):d.indexOf("Many")!=-1?d=10:isNaN(d)&&console.log("civilians",d);var h=""!=e.children?e.children:"0";h.indexOf("-")!=-1?(h=parseInt(h.split("-").pop()),isNaN(h)&&(h=parseInt(e.children.split("-")[0]))):h.indexOf("Unknown")!=-1||h.indexOf("Possibl")!=-1||h.indexOf("Yes")!=-1?h=1:h.indexOf("At least")!=-1?(h=h.replace("At least"," "),h=h.split(" "),h.forEach(function(e){isNaN(parseInt(e))||(h=parseInt(e))})):isNaN(h)&&console.log("children",h),parseInt(s)==parseInt(l)&&n==o&&(i+=parseInt(d),r+=parseInt(h))}),l.push(i),d.push(r)});var h={color:["#84e1cb","#e97b21"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"0%",right:"0%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:o,axisTick:{alignWithLabel:!0},axisLine:{lineStyle:{color:"#445b77"}}}],yAxis:[{type:"value",axisLine:{lineStyle:{color:"#445b77"}}}],series:[{name:"Total Civilians Killed",type:"bar",data:l},{name:"Total Children Killed",type:"bar",data:d}],textStyle:{color:"rgba(255, 255, 255, 1)"}};i.setOption(h)},e.summarizeResults(i),e.setSort=function(){""==e.sorter&&(i=e.initialDroneData),"latest"==e.sorter&&(i=a("orderBy")(i,"date",!0)),"oldest"==e.sorter&&(i=a("orderBy")(i,"date")),"country"==e.sorter&&(i=a("orderBy")(i,"country")),"max_deaths"==e.sorter&&(i=a("orderBy")(i,e.sortByDeaths,!0)),"min_deaths"==e.sorter&&(i=a("orderBy")(i,e.sortByDeaths)),"max_injuries"==e.sorter&&(i=a("orderBy")(i,e.sortByInjuries,!0)),"min_injuries"==e.sorter&&(i=a("orderBy")(i,e.sortByInjuries)),"max_civilian_deaths"==e.sorter&&(i=a("orderBy")(i,e.sortByCivilianDeaths,!0)),"min_civilian_deaths"==e.sorter&&(i=a("orderBy")(i,e.sortByCivilianDeaths)),"max_child_deaths"==e.sorter&&(i=a("orderBy")(i,e.sortByChildDeaths,!0)),"min_child_deaths"==e.sorter&&(i=a("orderBy")(i,e.sortByChildDeaths)),e.setPage(1)},e.pagedDroneData=[],e.totalItems=i.length,e.currentPage=1,e.maxSize=5,e.itemsPerPage=20;var r=(e.currentPage-1)*e.itemsPerPage,n=r+e.itemsPerPage;e.sorter="latest","latest"==e.sorter&&(e.pagedDroneData=i.slice(r,n)),e.setPage=function(t){e.currentPage=t,e.pageChanged(),console.log("filtered",i)},e.pageChanged=function(){e.totalItems=i.length,app.showProcessing(),console.log("Page changed to: "+e.currentPage);var t=(e.currentPage-1)*e.itemsPerPage,a=t+e.itemsPerPage;e.pagedDroneData=i.slice(t,a),$("body").animate({scrollTop:$("body").offset().top+750},1400),app.hideProcessing()},$(document).ready(function(){$(".data-Item").on("mouseover",function(e){$(".image",this).addClass("animate-top")}),$(".data-Item").on("mouseout",function(){$(".image",this).removeClass("animate-top")})})}},$.ajax({type:"POST",url:"getdata.php",dataType:"json",data:{dbData:!0},success:function(a){console.log("Get DB Data Response",a),a.data.strike.length>0?(e.isDbData=!0,e.onDataResponse(a),e.$apply(),console.log("Showing DB Data",a)):t({method:"jsonp",url:r}).then(e.onDataResponse,function(e){app.hideProcessing(),alert("Error in Requesting Data"),console.log("Error in Requesting Data",e)})},error:function(a){console.log("Get DB Data Error",a,a.responseText),t({method:"jsonp",url:r}).then(e.onDataResponse,function(e){app.hideProcessing(),alert("Error in Requesting Data"),console.log("Error in Requesting Data",e)})}})}]);